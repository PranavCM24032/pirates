<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="view-transition" content="same-origin">
    <title>Pirate Quest Timer</title>
    <script>
        // Dynamic base path configuration for local & GitHub Pages compatibility
        (function() {
            const getBasePath = () => {
                const href = window.location.href;
                // Check if running on GitHub Pages
                if (href.includes('github.io')) {
                    const parts = new URL(href).pathname.split('/').filter(Boolean);
                    // If path has more than just the filename, it's a project site
                    if (parts.length > 1 && !parts[0].includes('.')) {
                        return '/' + parts[0] + '/';
                    }
                }
                // For local or user/org GitHub Pages, use root
                return '/';
            };
            const basePath = getBasePath();
            if (basePath !== '/') {
                document.write('<base href="' + basePath + '">');
            }
            window.BASE_PATH = basePath;
        })();
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Pixelify+Sans:wght@400..700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="global.js" defer></script>
    <style>
        :root {
            --mc-gold: #FFD700;
            --mc-grass: #55FF55;
            --mc-danger: #FF5555;
            --mc-warning: #FFAA00;
            --mc-dark: rgba(0, 0, 0, 0.85);
            --shadow-text: 4px 4px 0px rgba(0, 0, 0, 0.8);
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            background: #000;
            color: white;
            font-family: 'Press Start 2P', cursive;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- Background Layers --- */
        /* --- Background Layers --- */
        #bg-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            background-image: url('images/ocean.png');
            background-size: cover;
            background-position: center;
            filter: brightness(0.6);
            transition: opacity 1s ease;
            /* Scale up to allow movement without showing edges */
            transform: scale(1.15);
        }

        /* Removed internal cameraMove animation in favor of global .move-cinematic */

        #video-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            opacity: 0;
            pointer-events: none;
            background: black;
            transition: opacity 1s ease;
        }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        body.video-active #bg-layer {
            opacity: 0;
        }

        body.video-active #video-layer {
            opacity: 1;
            pointer-events: all;
        }

        body.video-active .main-content {
            opacity: 0;
            transform: scale(0.9);
            pointer-events: none;
        }

        /* --- Main Content (Center) --- */
        .main-content {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.8s ease;
            width: 100%;
        }

        /* Logo */
        .pirate-logo {
            margin-bottom: 2rem;
            animation: floatLogo 4s ease-in-out infinite;
        }

        @keyframes floatLogo {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .grand-title {
            font-size: clamp(2rem, 5vw, 4rem);
            color: var(--mc-gold);
            text-shadow:
                4px 4px 0 #000,
                0 0 30px rgba(255, 170, 0, 0.4);
            letter-spacing: 5px;
            line-height: 1.2;
        }

        .decoration {
            font-size: 2rem;
            color: rgba(255, 255, 255, 0.8);
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .line {
            width: 50px;
            height: 3px;
            background: rgba(255, 255, 255, 0.5);
        }

        /* Huge Timer Display */
        .timer-huge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1vw;
            padding: 20px;
            cursor: pointer;
            /* Click to open settings */
            transition: transform 0.2s;
        }

        .timer-huge:hover {
            transform: scale(1.02);
        }

        .time-box {
            font-size: clamp(4rem, 12vw, 10rem);
            color: #FFF;
            text-shadow: 6px 6px 0 rgba(0, 0, 0, 0.8);
            line-height: 1;
            min-width: 1.8ch;
            text-align: center;
        }

        .dots {
            font-size: clamp(3rem, 8vw, 8rem);
            color: rgba(255, 255, 255, 0.5);
            margin-top: -1rem;
            text-shadow: 4px 4px 0 rgba(0, 0, 0, 0.8);
        }

        /* Urgent State (Under 1 min) */
        .time-box.urgent {
            color: var(--mc-danger);
            text-shadow: 4px 4px 0 #000, 0 0 30px var(--mc-danger);
            animation: pulseUrgent 1s infinite alternate;
        }

        .dots.urgent {
            color: var(--mc-danger);
            opacity: 0.8;
            text-shadow: 0 0 20px var(--mc-danger);
        }

        @keyframes pulseUrgent {
            from {
                transform: scale(1);
            }

            to {
                transform: scale(1.02);
            }
        }

        .status-badge {
            margin-top: 2rem;
            font-family: 'Pixelify Sans', sans-serif;
            font-size: 1.2rem;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 30px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(5px);
            letter-spacing: 3px;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.8);
        }

        /* --- Admin Toggle Button --- */
        #admin-toggle {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            cursor: pointer;
            backdrop-filter: blur(8px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #admin-toggle:hover {
            background: var(--mc-gold);
            border-color: var(--mc-gold);
            transform: rotate(90deg);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
        }

        #admin-toggle svg {
            width: 28px;
            height: 28px;
            fill: currentColor;
        }

        #admin-toggle:hover svg {
            fill: black;
        }

        /* --- Admin Sidebar Panel --- */
        .admin-sidebar {
            position: fixed;
            top: 0;
            right: 0;
            width: 380px;
            height: 100%;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 101;
            padding: 40px 30px;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: -10px 0 50px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            gap: 30px;
            overflow-y: auto;
            /* ENABLE SCROLLING FOR SIDEBAR */
        }

        .admin-sidebar.open {
            transform: translateX(0);
        }

        .sidebar-header {
            font-family: 'Pixelify Sans', sans-serif;
            font-size: 1.5rem;
            color: var(--mc-gold);
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .close-sidebar {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        .close-sidebar:hover {
            color: white;
        }

        /* Sidebar Sections */
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .group-label {
            font-family: 'Pixelify Sans', sans-serif;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.9rem;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Input Controls */
        .input-row {
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }

        .time-field {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            flex: 1;
        }

        .time-field input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            font-family: 'Press Start 2P', cursive;
            padding: 12px 0;
            text-align: center;
            border-radius: 8px;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .time-field input:focus {
            border-color: var(--mc-gold);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
        }

        .time-field label {
            font-size: 0.7rem;
            color: #888;
            font-family: 'Pixelify Sans', sans-serif;
        }

        /* Action Buttons */
        .btn-large {
            width: 100%;
            padding: 15px;
            font-family: 'Pixelify Sans', sans-serif;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 2px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            border-radius: 8px;
            text-transform: uppercase;
        }

        .btn-primary {
            background: var(--mc-gold);
            color: black;
            box-shadow: 0 4px 0 #b37700;
        }

        .btn-primary:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .btn-grass {
            background: var(--mc-grass);
            color: black;
            box-shadow: 0 4px 0 #2a8a2a;
        }

        .btn-grass:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .btn-danger {
            background: rgba(255, 85, 85, 0.1);
            color: var(--mc-danger);
            border: 1px solid var(--mc-danger);
        }

        .btn-danger:hover {
            background: var(--mc-danger);
            color: white;
        }

        /* Adjustment Grid */
        .adj-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .adj-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Pixelify Sans', sans-serif;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .adj-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .adj-btn.add {
            color: var(--mc-grass);
            border-color: rgba(85, 255, 85, 0.3);
        }

        .adj-btn.sub {
            color: var(--mc-danger);
            border-color: rgba(255, 85, 85, 0.3);
        }

        /* --- Video Reset Btn --- */
        #video-end-btn {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 200;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid var(--mc-grass);
            color: var(--mc-grass);
            padding: 15px 40px;
            font-family: 'Pixelify Sans', sans-serif;
            font-size: 1.2rem;
            letter-spacing: 2px;
            cursor: pointer;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
            border-radius: 30px;
        }

        #video-end-btn.visible {
            opacity: 1;
            pointer-events: auto;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .admin-sidebar {
                width: 100%;
            }

            .timer-huge {
                gap: 10px;
                padding: 10px;
            }

            .time-box {
                font-size: clamp(2.5rem, 15vw, 6rem);
                min-width: 1.5ch;
            }

            .dots {
                font-size: clamp(1.5rem, 10vw, 4rem);
                margin-top: -0.5rem;
            }

            .grand-title {
                font-size: 1.8rem;
            }
        }

        @media (max-width: 400px) {
            .timer-huge {
                gap: 5px;
            }

            .time-box {
                font-size: clamp(2rem, 18vw, 4rem);
            }

            .dots {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>

    <div id="bg-layer" class="move-cinematic"></div>
    <div id="video-layer">
        <video id="player" playsinline>
            <source src="images/ship_video.mp4" type="video/mp4">
        </video>
    </div>

    <!-- Main Clean Display -->
    <main class="main-content">
        <div class="pirate-logo">
            <img src="images/logo.png" alt="Bounty Pirates" class="w-full max-w-[400px] h-auto mx-auto mb-2">
            <div class="decoration">
                <span class="line"></span> ☠️ <span class="line"></span>
            </div>
        </div>

        <div class="timer-huge" onclick="toggleAdmin()">
            <div id="disp-h" class="time-box">00</div>
            <div class="dots">:</div>
            <div id="disp-m" class="time-box">00</div>
            <div class="dots">:</div>
            <div id="disp-s" class="time-box">05</div>
        </div>

        <div id="status-badge" class="status-badge">READY TO START</div>
    </main>

    <!-- Floating Toggle -->
    <button id="admin-toggle" onclick="toggleAdmin()">
        <svg viewBox="0 0 24 24">
            <path
                d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L6.69 5.87c-.12.21-.07.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
        </svg>
    </button>

    <!-- Admin Sidebar -->
    <aside id="admin-panel" class="admin-sidebar">
        <div class="sidebar-header">
            <span>ADMIN CONTROLS</span>
            <button class="close-sidebar" onclick="toggleAdmin()">×</button>
        </div>

        <!-- Timer Setup -->
        <div class="control-group">
            <div class="group-label">Set Duration</div>
            <div class="input-row">
                <div class="time-field">
                    <input type="number" id="set-h" value="00" min="0">
                    <label>HR</label>
                </div>
                <div class="time-field">
                    <input type="number" id="set-m" value="00" min="0">
                    <label>MIN</label>
                </div>
                <div class="time-field">
                    <input type="number" id="set-s" value="05" min="0">
                    <label>SEC</label>
                </div>
            </div>
            <button class="btn-large btn-primary" onclick="initTimer()">
                Update Display
            </button>
        </div>

        <hr style="border: 0; border-top: 1px solid rgba(255,255,255,0.1);">

        <!-- Playback Controls -->
        <div class="control-group">
            <div class="group-label">Playback</div>
            <button id="main-action-btn" class="btn-large btn-grass" onclick="toggleTimer()">
                START TIMER
            </button>
            <button class="btn-large btn-danger" onclick="resetSystem()">
                RESET SYSTEM
            </button>
        </div>

        <!-- Adjustments -->
        <!-- Live Adjustments -->
        <div class="control-group">
            <div class="group-label">Live Adjustment (Add/Sub)</div>
            <div class="input-row">
                <div class="time-field">
                    <input type="number" id="adj-h" value="00" min="0" placeholder="00">
                    <label>HR</label>
                </div>
                <div class="time-field">
                    <input type="number" id="adj-m" value="00" min="0" placeholder="00">
                    <label>MIN</label>
                </div>
                <div class="time-field">
                    <input type="number" id="adj-s" value="30" min="0" placeholder="00">
                    <label>SEC</label>
                </div>
            </div>
            <div class="adj-grid">
                <button class="adj-btn sub" onclick="adjustTime(-1)">- REMOVE</button>
                <button class="adj-btn add" onclick="adjustTime(1)">+ ADD</button>
            </div>
        </div>
    </aside>

    <button id="video-end-btn" onclick="resetSystem()">REBOOT SYSTEM</button>

    <script>
        // State
        let timer = {
            totalSeconds: 5, // Default start
            remaining: 5,
            interval: null,
            isRunning: false,
            isFinished: false
        };

        // DOM Elements
        const display = {
            h: document.getElementById('disp-h'),
            m: document.getElementById('disp-m'),
            s: document.getElementById('disp-s'),
            badge: document.getElementById('status-badge'),
            actionBtn: document.getElementById('main-action-btn')
        };

        const inputs = {
            h: document.getElementById('set-h'),
            m: document.getElementById('set-m'),
            s: document.getElementById('set-s')
        };

        // --- Broadcasting ---
        function broadcastTimer() {
            const state = {
                remaining: timer.remaining,
                isRunning: timer.isRunning,
                isFinished: timer.isFinished,
                timestamp: Date.now()
            };
            localStorage.setItem('pirate_timer_state', JSON.stringify(state));
        }

        // Initialize Display
        function format(num) { return num.toString().padStart(2, '0'); }

        function updateDisplay() {
            const h = Math.floor(timer.remaining / 3600);
            const m = Math.floor((timer.remaining % 3600) / 60);
            const s = timer.remaining % 60;

            display.h.textContent = format(h);
            display.m.textContent = format(m);
            display.s.textContent = format(s);

            // Urgent Color Logic (<= 59 seconds)
            const timeElements = document.querySelectorAll('.time-box, .dots');
            if (timer.remaining <= 59 && timer.remaining > 0) {
                timeElements.forEach(el => el.classList.add('urgent'));
            } else {
                timeElements.forEach(el => el.classList.remove('urgent'));
            }

            // Update Badge Color/Status
            if (timer.isFinished) {
                display.badge.textContent = "TIME EXPIRED";
                display.badge.style.color = "#FF5555";
            } else if (timer.isRunning) {
                display.badge.textContent = "TIMER ACTIVE";
                display.badge.style.color = "#55FF55";
            } else {
                display.badge.textContent = "READY / PAUSED";
                display.badge.style.color = "#FFAA00";
            }

            // Broadcast state on every update
            broadcastTimer();
        }

        // --- Core Functions ---

        function initTimer() {
            // Read from inputs
            const h = parseInt(inputs.h.value) || 0;
            const m = parseInt(inputs.m.value) || 0;
            const s = parseInt(inputs.s.value) || 0;

            const total = (h * 3600) + (m * 60) + s;
            if (total <= 0) return alert("Please set a valid time!");

            stopInterval();
            timer.totalSeconds = total;
            timer.remaining = total;
            timer.isRunning = false;
            timer.isFinished = false;

            updateDisplay();
            display.actionBtn.textContent = "START TIMER";
            display.actionBtn.className = "btn-large btn-grass";
        }

        function toggleTimer() {
            if (timer.remaining <= 0 && !timer.isFinished) {
                initTimer(); // Try to init if 0 but not finished state?
                if (timer.remaining <= 0) return;
            }

            if (timer.isRunning) {
                pauseTimer();
            } else {
                startTimer();
            }
        }

        function startTimer() {
            if (timer.remaining <= 0) return;

            timer.isRunning = true;
            timer.isFinished = false;

            // DRIFT FIX: Calculate target end time based on current remaining seconds
            timer.endTime = Date.now() + (timer.remaining * 1000);

            timer.interval = setInterval(tick, 200); // Check more frequently for responsiveness

            // Visual Updates
            display.actionBtn.textContent = "PAUSE TIMER";
            display.actionBtn.className = "btn-large"; // Neutral style or yellow
            display.actionBtn.style.background = "#FFAA00";

            updateDisplay();
        }

        function pauseTimer() {
            stopInterval();
            timer.isRunning = false;

            // Capture exact remaining time for resume
            // (No need to recalc remaining here as tick() keeps it updated, 
            // but for safety/precision on pause click):
            if (timer.endTime) {
                const now = Date.now();
                const left = Math.ceil((timer.endTime - now) / 1000);
                timer.remaining = Math.max(0, left);
            }

            display.actionBtn.textContent = "RESUME TIMER";
            display.actionBtn.className = "btn-large btn-grass";
            updateDisplay();
        }

        function stopInterval() {
            if (timer.interval) clearInterval(timer.interval);
            timer.interval = null;
        }

        function tick() {
            const now = Date.now();
            if (!timer.endTime) return;

            // Calculate remaining based on delta
            const diff = timer.endTime - now;
            const secLeft = Math.ceil(diff / 1000);

            if (secLeft > 0) {
                // Update state if changed
                if (timer.remaining !== secLeft) {
                    timer.remaining = secLeft;
                    updateDisplay();
                }
            } else {
                timer.remaining = 0;
                updateDisplay();
                finishGame();
            }
        }

        function finishGame() {
            stopInterval();
            timer.isRunning = false;
            timer.isFinished = true;
            timer.endTime = null; // Clear
            updateDisplay();

            // Trigger Video
            document.body.classList.add('video-active');
            const video = document.getElementById('player');
            video.currentTime = 0;
            video.play().catch(e => console.log("Autoplay blocked", e));

            video.onended = () => {
                document.getElementById('video-end-btn').classList.add('visible');
            };
        }

        function resetSystem() {
            stopInterval();
            document.body.classList.remove('video-active');
            document.getElementById('video-end-btn').classList.remove('visible');

            const video = document.getElementById('player');
            video.pause();

            initTimer(); // Reset to input values
        }

        // --- Adjustment Logic ---
        function adjustTime(multiplier, specificDelta = null) {
            let delta;
            if (specificDelta !== null) {
                delta = specificDelta * multiplier;
            } else {
                const h = parseInt(document.getElementById('adj-h').value) || 0;
                const m = parseInt(document.getElementById('adj-m').value) || 0;
                const s = parseInt(document.getElementById('adj-s').value) || 0;
                delta = ((h * 3600) + (m * 60) + s) * multiplier;
            }

            if (delta === 0) return;
            timer.remaining += delta;
            if (timer.remaining < 0) timer.remaining = 0;

            if (timer.isRunning) {
                timer.endTime = Date.now() + (timer.remaining * 1000);
            } else if (!timer.isFinished) {
                timer.totalSeconds = timer.remaining;
                inputs.h.value = format(Math.floor(timer.remaining / 3600));
                inputs.m.value = format(Math.floor((timer.remaining % 3600) / 60));
                inputs.s.value = format(timer.remaining % 60);
            }
            updateDisplay();
        }

        // --- UI Interactions ---

        function toggleAdmin() {
            document.getElementById('admin-panel').classList.toggle('open');
        }

        // Initial setup
        initTimer();

        // --- Remote Control Hub ---
        window.addEventListener('storage', (e) => {
            if (e.key === 'pirate_timer_command') {
                try {
                    const cmd = JSON.parse(e.newValue || '{}');
                    if (!cmd.action || Date.now() - cmd.timestamp > 5000) return;
                    if (cmd.action === 'INIT') {
                        inputs.h.value = format(cmd.data.h || 0);
                        inputs.m.value = format(cmd.data.m || 0);
                        inputs.s.value = format(cmd.data.s || 0);
                        initTimer();
                    } else if (cmd.action === 'TOGGLE') {
                        toggleTimer();
                    } else if (cmd.action === 'ADJUST') {
                        adjustTime(cmd.data.delta > 0 ? 1 : -1, Math.abs(cmd.data.delta));
                    } else if (cmd.action === 'RESET') {
                        resetSystem();
                    }
                } catch (err) { console.error('Remote cmd error', err); }
            }
        });
    </script>

</body>

</html>